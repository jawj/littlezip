var v,P=()=>{let f=Int32Array,c=new f(256),l=new f(4096),r,n,s;for(n=0;n<256;n++)r=n,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,l[n]=c[n]=r&1?-306674912^r>>>1:r>>>1;for(n=0;n<256;n++)for(s=c[n],r=256+n;r<4096;r+=256)s=l[r]=s>>>8^c[s&255];for(v=[c],n=1;n<16;n++)v[n]=l.subarray(n*256,(n+1)*256)},R=(f,c=0)=>{v||P();let[l,r,n,s,S,L,C,U,g,M,O,t,e,p,o,b]=v,i=c^-1,d=f.length-15,a=0;for(;a<d;)i=b[f[a++]^i&255]^o[f[a++]^i>>8&255]^p[f[a++]^i>>16&255]^e[f[a++]^i>>>24]^t[f[a++]]^O[f[a++]]^M[f[a++]]^g[f[a++]]^U[f[a++]]^C[f[a++]]^L[f[a++]]^S[f[a++]]^s[f[a++]]^n[f[a++]]^r[f[a++]]^l[f[a++]];for(d+=15;a<d;)i=i>>>8^l[(i^f[a++])&255];return~i};var Y=typeof CompressionStream<"u",W=new TextEncoder,Z=f=>f.reduce((c,l)=>c+l.byteLength,0);function j(f){let c=new CompressionStream("gzip"),l=c.writable.getWriter(),r=c.readable.getReader();return l.write(f),l.close(),()=>r.read()}async function K(f,c=!0,l=j){let r=[],n=Y&&c,s=f.length,S=f.map(o=>W.encode(o.name)),L=f.map(({data:o})=>typeof o=="string"?W.encode(o):o instanceof ArrayBuffer?new Uint8Array(o):o),C=Z(L),U=Z(S),g=s*46+U,M=C+s*30+U+g+22,O=new Date,t=new Uint8Array(M),e=0;for(let o=0;o<s;o++){r[o]=e;let b=S[o],i=b.byteLength,d=L[o],a=d.byteLength,T=f[o].lastModified??O,I=Math.floor(T.getSeconds()/2)+(T.getMinutes()<<5)+(T.getHours()<<11),F=T.getDate()+(T.getMonth()+1<<5)+(T.getFullYear()-1980<<9),h=0,z=!1;t[e++]=80,t[e++]=75,t[e++]=3,t[e++]=4,t[e]=20,e+=3,t[e++]=8;let G=e;e+=2,t[e++]=I&255,t[e++]=I>>8,t[e++]=F&255,t[e++]=F>>8;let x=e;if(e+=8,t[e++]=a&255,t[e++]=a>>8&255,t[e++]=a>>16&255,t[e++]=a>>24,t[e++]=i&255,t[e]=i>>8&255,e+=3,t.set(b,e),e+=i,n){let m=e,E=l(d),y,A=0,k=0;e:{for(;;){let u=await E();if(u.done)throw new Error("Bad gzip data");if(y=u.value,A=k,k=A+y.length,A<=3&&k>3&&y[3-A]&30){z=!0;break e}if(k>=10){y=y.subarray(10-A);break}}for(;;){let u=e-m,w=y.byteLength;if(u+w>=a){z=!0;break e}t.set(y,e),e+=w;let N=await E();if(N.done)break;y=N.value}}if(z)for(;;){let u=y.byteLength,w=8-u,N=e;e=m;for(let D=0;D<8;D++)t[e++]=D<w?t[N-w+D]:y[u-8+D];let H=await E();if(H.done)break;y=H.value}e-=8,t[x++]=t[e++],t[x++]=t[e++],t[x++]=t[e++],t[x++]=t[e++],e-=4,z||(t[G]=8,h=e-m)}if((!n||z)&&(t.set(d,e),e+=a,h=a),!n){let m=R(d);t[x++]=m&255,t[x++]=m>>8&255,t[x++]=m>>16&255,t[x++]=m>>24}t[x++]=h&255,t[x++]=h>>8&255,t[x++]=h>>16&255,t[x++]=h>>24}let p=e;for(let o=0;o<s;o++){let b=r[o],i=S[o],d=i.byteLength;t[e++]=80,t[e++]=75,t[e++]=1,t[e++]=2,t[e]=20,e+=2,t[e]=20,e+=2,t.set(t.subarray(b+6,b+30),e),e+=34,t[e++]=b&255,t[e++]=b>>8&255,t[e++]=b>>16&255,t[e++]=b>>24,t.set(i,e),e+=d}return t[e++]=80,t[e++]=75,t[e++]=5,t[e]=6,e+=5,t[e++]=s&255,t[e++]=s>>8&255,t[e++]=s&255,t[e++]=s>>8&255,t[e++]=g&255,t[e++]=g>>8&255,t[e++]=g>>16&255,t[e++]=g>>24,t[e++]=p&255,t[e++]=p>>8&255,t[e++]=p>>16&255,t[e]=p>>24,t.subarray(0,e+3)}export{K as createZip};
