var L,P=()=>{let n=Int32Array,c=new n(256),i=new n(4096),r,f,l;for(f=0;f<256;f++)r=f,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,i[f]=c[f]=r&1?-306674912^r>>>1:r>>>1;for(f=0;f<256;f++)for(l=c[f],r=256+f;r<4096;r+=256)l=i[r]=l>>>8^c[l&255];for(L=[c],f=1;f<16;f++)L[f]=i.subarray(f*256,(f+1)*256)},j=(n,c=0)=>{L||P();let[i,r,f,l,S,M,A,O,y,U,v,t,N,e,g,o]=L,s=c^-1,x=n.length-15,a=0;for(;a<x;)s=o[n[a++]^s&255]^g[n[a++]^s>>8&255]^e[n[a++]^s>>16&255]^N[n[a++]^s>>>24]^t[n[a++]]^v[n[a++]]^U[n[a++]]^y[n[a++]]^O[n[a++]]^A[n[a++]]^M[n[a++]]^S[n[a++]]^l[n[a++]]^f[n[a++]]^r[n[a++]]^i[n[a++]];for(x+=15;a<x;)s=s>>>8^i[(s^n[a++])&255];return~s};var Q=typeof CompressionStream<"u",F=new TextEncoder,R=n=>n.reduce((c,i)=>c+i,0),H=10;async function _(n,c=!0){let i=[],r=Q&&c,f=n.length,l=n.map(o=>F.encode(o.name)),S=n.map(({data:o})=>typeof o=="string"?F.encode(o):o instanceof ArrayBuffer?new Uint8Array(o):o),M=R(S.map(o=>o.byteLength)),A=R(l.map(o=>o.byteLength)),O=f*30+A,y=f*46+A,U=22,v=O+y+U+Math.ceil(M*1.01)+f*128,t=new Uint8Array(v),N=new Date,e=0;for(let o=0;o<f;o++){i[o]=e;let s=l[o],x=s.byteLength,a=S[o],d=a.byteLength,u=n[o].lastModified??N,W=u.getSeconds(),Y=u.getMinutes(),q=u.getHours(),G=u.getDate(),J=u.getMonth()+1,K=u.getFullYear(),I=Math.floor(W/2)+(Y<<5)+(q<<11),k=G+(J<<5)+(K-1980<<9);t[e++]=80,t[e++]=75,t[e++]=3,t[e++]=4,t[e++]=20,t[e++]=0,t[e++]=0,t[e++]=8,t[e++]=r?8:0,t[e++]=0,t[e++]=I&255,t[e++]=I>>8,t[e++]=k&255,t[e++]=k>>8;let D=e;e+=4;let E=e;e+=4,t[e++]=d&255,t[e++]=d>>8&255,t[e++]=d>>16&255,t[e++]=d>>24,t[e++]=x&255,t[e++]=x>>8&255,t[e++]=0,t[e++]=0,t.set(s,e),e+=x;let h;if(r){let w=e,C=new CompressionStream("gzip"),Z=C.writable.getWriter(),$=C.readable.getReader();Z.write(a),Z.close();let b=0,T=0;for(;;){let z=await $.read();if(z.done)throw new Error("Unexpected end of gzip data");let p=z.value;if(b=T,T=b+p.length,b<=2&&T>2){let m=p[2-b];if(m!==8)throw new Error(`Assumptions violated: gzip not deflated (compression value: ${m})`)}if(b<=3&&T>3){let m=p[3-b];if(m&30)throw new Error(`Assumptions violated: one or more optional gzip flags present (flags: ${m})`)}if(T===H)break;if(T>H){let m=p.subarray(H-b);t.set(m,e),e+=m.byteLength;break}}for(;;){let z=await $.read();if(z.done)break;let p=z.value;t.set(p,e),e+=p.byteLength}e-=8,t[D++]=t[e++],t[D++]=t[e++],t[D++]=t[e++],t[D++]=t[e++],e-=4,h=e-w}else{t.set(a,e),e+=d,h=d;let w=j(a);t[e++]=w&255,t[e++]=w>>8&255,t[e++]=w>>16&255,t[e++]=w>>24}t[E++]=h&255,t[E++]=h>>8&255,t[E++]=h>>16&255,t[E++]=h>>24}let g=e;for(let o=0;o<f;o++){let s=i[o],x=l[o],a=x.byteLength;t[e++]=80,t[e++]=75,t[e++]=1,t[e++]=2,t[e++]=20,t[e++]=0,t[e++]=20,t[e++]=0,t.set(t.subarray(s+6,s+30),e),e+=24;for(let d=0;d<10;d++)t[e++]=0;t[e++]=s&255,t[e++]=s>>8&255,t[e++]=s>>16&255,t[e++]=s>>24,t.set(x,e),e+=a}return t[e++]=80,t[e++]=75,t[e++]=5,t[e++]=6,t[e++]=0,t[e++]=0,t[e++]=0,t[e++]=0,t[e++]=f&255,t[e++]=f>>8&255,t[e++]=f&255,t[e++]=f>>8&255,t[e++]=y&255,t[e++]=y>>8&255,t[e++]=y>>16&255,t[e++]=y>>24,t[e++]=g&255,t[e++]=g>>8&255,t[e++]=g>>16&255,t[e++]=g>>24,t[e++]=0,t[e++]=0,t.subarray(0,e)}export{_ as createZip};
