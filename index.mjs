var v,J=()=>{let f=Int32Array,m=new f(256),c=new f(4096),r,a,b;for(a=0;a<256;a++)r=a,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,r=r&1?-306674912^r>>>1:r>>>1,c[a]=m[a]=r&1?-306674912^r>>>1:r>>>1;for(a=0;a<256;a++)for(b=m[a],r=256+a;r<4096;r+=256)b=c[r]=b>>>8^m[b&255];for(v=[m],a=1;a<16;a++)v[a]=c.subarray(a*256,(a+1)*256)},P=(f,m=0)=>{v||J();let[c,r,a,b,z,M,A,g,U,E,t,e,T,s,l,d]=v,o=m^-1,i=f.length-15,n=0;for(;n<i;)o=d[f[n++]^o&255]^l[f[n++]^o>>8&255]^s[f[n++]^o>>16&255]^T[f[n++]^o>>>24]^e[f[n++]]^t[f[n++]]^E[f[n++]]^U[f[n++]]^g[f[n++]]^A[f[n++]]^M[f[n++]]^z[f[n++]]^b[f[n++]]^a[f[n++]]^r[f[n++]]^c[f[n++]];for(i+=15;n<i;)o=o>>>8^c[(o^f[n++])&255];return~o};var K=typeof CompressionStream<"u",R=new TextEncoder,Y=f=>f.reduce((m,c)=>m+c,0),q=Uint8Array,G=10;async function X(f,m=!0){let c=[],r=K&&m,a=f.length,b=f.map(s=>R.encode(s.name)),z=f.map(({data:s})=>typeof s=="string"?R.encode(s):s instanceof ArrayBuffer?new q(s):s),M=Y(z.map(s=>s.byteLength)),A=Y(b.map(s=>s.byteLength)),g=a*46+A,U=M+a*30+A+g+22,E=new Date,t=new q(U),e=0;for(let s=0;s<a;s++){c[s]=e;let l=b[s],d=l.byteLength,o=z[s],i=o.byteLength,n=f[s].lastModified??E,C=Math.floor(n.getSeconds()/2)+(n.getMinutes()<<5)+(n.getHours()<<11),F=n.getDate()+(n.getMonth()+1<<5)+(n.getFullYear()-1980<<9);t[e++]=80,t[e++]=75,t[e++]=3,t[e++]=4,t[e++]=20,t[e++]=0,t[e++]=0,t[e++]=8;let H=e++;t[e++]=0,t[e++]=C&255,t[e++]=C>>8,t[e++]=F&255,t[e++]=F>>8;let D=e;e+=4;let L=e;e+=4,t[e++]=i&255,t[e++]=i>>8&255,t[e++]=i>>16&255,t[e++]=i>>24,t[e++]=d&255,t[e++]=d>>8&255,t[e++]=0,t[e++]=0,t.set(l,e),e+=d;let u;if(r){let y=e,W=new CompressionStream("gzip"),Z=W.writable.getWriter(),I=W.readable.getReader(),x,w=0,O=0,N=!1;Z.write(o),Z.close();e:{for(;;){let p=await I.read();if(p.done)throw new Error("Unexpected end of gzip data");if(x=p.value,w=O,O=w+x.length,w<=3&&O>3&&x[3-w]&30){N=!0;break e}if(O>=G){x=x.subarray(G-w);break}}for(;;){let p=e-y,h=x.byteLength;if(p+h>=i){N=!0;break e}t.set(x,e),e+=h;let k=await I.read();if(k.done)break;x=k.value}}if(N)for(;;){let p=x.byteLength,h=8-p,k=e;e=y;for(let S=0;S<8;S++)t[e++]=S<h?t[k-h+S]:x[p-8+S];let j=await I.read();if(j.done)break;x=j.value}e-=8,t[D++]=t[e++],t[D++]=t[e++],t[D++]=t[e++],t[D++]=t[e++],e-=4,N?(t[H]=0,t.set(o,e),e+=i,u=i):(t[H]=8,u=e-y)}else{t[H]=0,t.set(o,e),e+=i,u=i;let y=P(o);t[e++]=y&255,t[e++]=y>>8&255,t[e++]=y>>16&255,t[e++]=y>>24}t[L++]=u&255,t[L++]=u>>8&255,t[L++]=u>>16&255,t[L++]=u>>24}let T=e;for(let s=0;s<a;s++){let l=c[s],d=b[s],o=d.byteLength;t[e++]=80,t[e++]=75,t[e++]=1,t[e++]=2,t[e++]=20,t[e++]=0,t[e++]=20,t[e++]=0,t.set(t.subarray(l+6,l+30),e),e+=24;for(let i=0;i<10;i++)t[e++]=0;t[e++]=l&255,t[e++]=l>>8&255,t[e++]=l>>16&255,t[e++]=l>>24,t.set(d,e),e+=o}return t[e++]=80,t[e++]=75,t[e++]=5,t[e++]=6,t[e++]=0,t[e++]=0,t[e++]=0,t[e++]=0,t[e++]=a&255,t[e++]=a>>8&255,t[e++]=a&255,t[e++]=a>>8&255,t[e++]=g&255,t[e++]=g>>8&255,t[e++]=g>>16&255,t[e++]=g>>24,t[e++]=T&255,t[e++]=T>>8&255,t[e++]=T>>16&255,t[e++]=T>>24,t[e++]=0,t[e++]=0,t.subarray(0,e)}export{X as createZip};
